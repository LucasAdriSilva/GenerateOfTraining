{% extends 'base.html' %}


{% block content %}


<div id="quiz" data-bs-touch="false" class="carousel slide my-5">
    <div class="row mb-2">
        <div class="col-12 d-flex justify-content-center align-items-center ">
            <h5 class="reset text-uppercase">
                Para gerar seu treino
            </h5>
        </div>
    </div>
    <div class="row mb-5 mx-3">
        <div class="col-12 d-flex justify-content-center align-items-center rounded-2 bg-quiz p-2">
            <h4 class="reset text-uppercase fw-bolder">Responda o quiz abaixo</h4>
        </div>
    </div>

    <div class="carousel-inner px-3">
        <div class="carousel-item active">
            <div class="row gap-3">
                <!-- Quest -->
                <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                    <h3 class="text-center">Quais equiamentos você tem para trienar? Marque abaixo:</h3>
                </div>

                <div class="col-12 bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Barra Paralela 80cm</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Paralelas" id="ParalelaT" value="true">
                        <label class="form-check-label" for="ParalelaT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Paralelas" id="ParalelaF" value="false">
                        <label class="form-check-label" for="ParalelaF">
                            Não
                        </label>
                    </div>
                </div>

                <div class="col-12 bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Barra fixa de porta, parede ou de chão</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Barra Fixa" id="barraFixaT" value="true">
                        <label class="form-check-label" for="barraFixaT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Barra Fixa" id="barraFixaF" value="false">
                        <label class="form-check-label" for="barraFixaF">
                            Não
                        </label>
                    </div>
                </div>

                <div class="col-12  bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">TRX</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Trx" id="trxT" value="true">
                        <label class="form-check-label" for="trxT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Trx" id="trxF" value="false">
                        <label class="form-check-label" for="trxF">
                            Não
                        </label>
                    </div>
                </div>

                <div class="col-12  bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Rodinha Abdominal</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Rodinha Abdominal" id="rodinhaT"
                            value="true">
                        <label class="form-check-label" for="rodinhaT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Rodinha Abdominal" id="rodinhaF"
                            value="false">
                        <label class="form-check-label" for="rodinhaF">
                            Não
                        </label>
                    </div>
                </div>

                <div class="col-12  bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Argolas de madeira</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Argolas" id="argolasT" value="true">
                        <label class="form-check-label" for="argolasT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Argolas" id="argolasF" value="false">
                        <label class="form-check-label" for="argolasF">
                            Não
                        </label>
                    </div>
                </div>

                <div class="col-12  bg-gray2 px-3 py-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Super Bands</span>
                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Superband" id="superbandT" value="true">
                        <label class="form-check-label" for="superbandT">
                            Sim
                        </label>
                    </div>

                    <div class="form-check form-check-square">
                        <input class="form-check-input" type="radio" name="Superband" id="superbandF" value="false">
                        <label class="form-check-label" for="superbandF">
                            Não
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <div class="carousel-item ">
            <div class="row gap-1">
                <!-- Quest -->
                <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                    <h3 class="text-center">Quantos dias você tem para treinar?</h3>
                </div>

                <div class="col-12 bg-gray px-3 py-2 rounded-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Dias</span>
                    <select id="days" class="form-select w-50" aria-label="Default select example">
                        <option class="text-center" selected>Dias</option>
                        <option class="text-center" value="3">3</option>
                        <option class="text-center" value="4">4</option>
                    </select>
                </div>

                <div class="col-12 d-flex flex-column justify-content-center align-items-center mt-5">
                    <h3 class="text-center">Quanto tempo por dia você tem (com certeza)?</h3>
                </div>
                <div class="col-12  bg-gray px-3 py-2 rounded-2 d-flex justify-content-between align-items-center">
                    <span class="w-50">Horas</span>

                    <select id="hours" class="form-select w-50 mx-3" aria-label="Default select example">
                        <option class="text-center" selected value="0">Horas</option>
                        <option class="text-center" value="0">0 Hora</option>
                        <option class="text-center" value="1">1 Hora</option>
                        <option class="text-center" value="2">2 Horas</option>
                        <option class="text-center" value="3">3 Horas</option>
                        <option class="text-center" value="4">4 Horas</option>
                    </select>


                    <select id="min" class="form-select w-50 mx-3" aria-label="Default select example">
                        <option class="text-center" selected value="0">Min.</option>
                        <option class="text-center" value="0">0 Min</option>
                        <option class="text-center" value="5">5 Min</option>
                        <option class="text-center" value="10">10 Min</option>
                        <option class="text-center" value="15">15 Min</option>
                        <option class="text-center" value="20">20 Min</option>
                        <option class="text-center" value="25">25 Min</option>
                        <option class="text-center" value="30">30 Min</option>
                        <option class="text-center" value="35">35 Min</option>
                        <option class="text-center" value="40">40 Min</option>
                        <option class="text-center" value="45">45 Min</option>
                        <option class="text-center" value="50">50 Min</option>
                        <option class="text-center" value="55">55 Min</option>
                    </select>

                </div>

                <div id="timeErr" class="col-12 d-none d-flex justify-content-center align-i">

                    <span class="text-danger text-center">O limite minimo de tempo é de 40 minutos, por favor altere
                        o
                        tempo do seu treino</span>
                </div>

                <!-- <div class="col-12  bg-gray px-3 py-2 rounded-2 d-flex justify-content-between align-items-center">
                    <span class class="text-center"="w-50">Minutos</span>

                    <select id="min" class="form-select w-50" aria-label="Default select example">
                        <option class="text-center" selected>Min.</option>
                        <option class="text-center" value="0">0 Min</option>
                        <option class="text-center" value="5">5 Min</option>
                        <option class="text-center" value="10">10 Min</option>
                        <option class="text-center" value="15">15 Min</option>
                        <option class="text-center" value="20">20 Min</option>
                        <option class="text-center" value="25">25 Min</option>
                        <option class="text-center" value="30">30 Min</option>
                        <option class="text-center" value="35">35 Min</option>
                        <option class="text-center" value="40">40 Min</option>
                        <option class="text-center" value="45">45 Min</option>
                        <option class="text-center" value="50">50 Min</option>
                        <option class="text-center" value="55">55 Min</option>
                    </select>
                </div> -->
            </div>
        </div>

    </div>

    <!-- <button class="carousel-control-prev" type="button" data-bs-target="#quiz" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#quiz" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
    </button> -->
</div>

<div id="msgErr" class="row d-none my-5">
    <div class="col-12 mb-2 d-flex justify-content-center align-items-center">
        <h1 class="reset text-uppercase fw-bolder">Ops! </h1>
    </div>

    <div class="col-12 d-flex justify-content-center align-items-center">
        <div class="rounded-4 bg-orange2 p-3 text-center">
            <span class="reset fs-6 text-uppercase fw-bold">
                Parece que você não possui todos os equipamentos necessários para gerar este treino personalizado.
            </span>
        </div>

    </div>

    <div class="col-12 d-flex justify-content-center align-items-center">
        <span class="p-4 reset fs-6 text-center ">
            Nós entendemos que isso pode ser frustrante, mas estamos aqui para ajudar. Para obter melhores
            resultados,
            sugerimos outras opções
        </span>
    </div>

    <div class="col-12">
        <div class="row px-4 py-1">
            <div class="col-12 d-flex justify-content-center align-items-center"
                style="background-color: rgb(192, 192, 192);">
                <span class="reset text-uppercase fs-5 fw-bolder p-2"> opção 1</span>
            </div>
            <div class="col-12 d-flex justify-content-center align-items-center" style="background-color: rgb(240, 240, 240);
            ">
                <span class="reset fs-4 py-3 px-2"> Comprar uma barra fixa</span>
            </div>
        </div>

        <div class="row px-4 py-1">
            <div class="col-12 d-flex justify-content-center align-items-center"
                style="background-color: rgb(192, 192, 192);">
                <span class="reset text-uppercase fs-5 fw-bolder p-2"> opção 2</span>
            </div>
            <div class="col-12 d-flex flex-column justify-content-center align-items-center" style="background-color: rgb(240, 240, 240);
            ">
                <span class="reset fs-4 py-3 px-2 text-center">Fazer o programa na academia</span>
                <div class="d-flex justify-content-center align-items-center gap-3">
                    <button class="btn btn-success mb-3" onclick="saveRequireds(true)">Musculação</button>
                    <button class="btn btn-success mb-3" onclick="saveRequireds(false)">Hibridro</button>

                </div>
            </div>
        </div>

        <div class="row px-4 py-1">
            <div class="col-12 d-flex justify-content-center align-items-center"
                style="background-color: rgb(192, 192, 192);">
                <span class="reset text-uppercase fs-5 fw-bolder p-2"> opção 3</span>
            </div>
            <div class="col-12 d-flex justify-content-center align-items-center" style="background-color: rgb(240, 240, 240);
            ">
                <span class="reset fs-4 py-3 px-2 text-center">Improvisar a barra australiana em algum lugar, ou a
                    barra
                    australiana pode ser seu único exercício de pull</span>
            </div>
        </div>
    </div>

</div>

<div id="div2" class="row d-none mt-5 rounded-3 d-flex justify-content-center align-content-center ">

    <div class="col-12">
        <h1 class="reset text-center">Crie seu treino</h1>
        <h3 class="reset text-center">Com o peso do corpo</h3>
    </div>

    <div class="col-12 p-3 d-flex flex-column">
        <span class="text-center">Utilize esse treino pronto para saber seu nivel.</span>
        <span class="text-center">Faça o maximo de repetições que conseguir fazer</span>
        <span class="text-center">E adicione as informações abaixo</span>
    </div>

    <!-- <div class="col-12 d-flex justify-content-center align-items-center gap-1">
        <div class="form-check form-switch">
            <input class="form-check-input border-switch" type="checkbox" role="switch" id="pairedSetsValue">
            <label class="form-check-label" for="pairedSetsValue">Paired Sets</label>
        </div>
        <img src="assets/img/interrog.jpg" onclick="openModal('pairedSets')" width="20" height="20" alt="">
    </div> -->

    <!-- <div id="exer1" class="col-lg-5 position-relative col-11 d-flex justify-content-center align-items-center rounded-3 p-2 m-2 bg-white" style="border: 1px solid rgb(163, 163, 163);">

        <div class="row position-relative">
            
            <div class="col-3 d-flex justify-content-center align-items-center">
                <img class="rounded-4" id="img1" width="68" height="68"
                    src="https://aprovataf.com.br/wp-content/uploads/2016/04/Flex%C3%A3o-de-bra%C3%A7o-no-solo-AprovaTAF.jpg"
                    alt="">
            </div>

            <div class="col-9 d-flex align-items-center ps-3 pe-5" >
                <div class="row" >
                    <div class="col-12 reset-Padding">
                        <span class="reset text-uppercase" style="font-size: 18px;">Nome do exercicio 
                            exercicio</span>
                    </div>

                    <div class="col-4 d-flex flex-column justify-content-center align-items-start my-2 reset-Padding">
                        <p class="reset text-uppercase text-gray1">SÉRIE</p>
                        <input class="w-75 text-center rounded-3" type="text" placeholder="1" disabled>
                    </div>

                    <div class="col-4 d-flex flex-column justify-content-center align-items-center reset-Padding">
                        <p id="rept1" class="reset text-uppercase text-gray1">REPS</p>
                        <input required="true" id="ValidExer1" class=" w-75 input-value text-center rounded-3"
                            type="text">
                    </div>

                    <div class="col-4 d-flex flex-column justify-content-center align-items-end reset-Padding">
                        <p  class="reset text-uppercase text-gray1">RESET</p>
                        <input required="true" disabled placeholder="3min"
                            class="w-75 input-value text-center rounded-3" type="text">
                    </div>
                </div>
                
                <i class="bi bi-three-dots-vertical position-absolute top-0 end-0 "></i>
            </div>
            
            <div id="toggleExer1" class="col-12 d-none d-flex flex-column justify-content-center">
                <button id="btn1" onclick="filter(1, 'Push', 'Horizontal')" class="btn btn-primary w-100" type="button">Trocar Exercicío</button>

                <span id="heavy1" class="reset text-center d-none" style="font-size: 10px;">
                    *Ops, sua quantidade de repetição está baixa! Vamos trocar para um mais leve?
                </span>

                <span id="light1" class="reset text-center d-none" style="font-size: 10px;">
                    *Ops, sua quantidade de repetição está alta! Vamos trocar para um mais pesado?
                </span> 

                <span id="success1" class="reset text-center text-success d-none" style="font-size: 10px;">
                    Perfeito, podemos prosseguir!
                </span> 
            </div>
        </div>
    </div> -->
    <!-- <div id="exer1" class="col-lg-5 col-11 position-relative rounded-3 m-2 bg-white"
        style="border: 1px solid rgb(20, 20, 20);">
        <div class="row reset-Padding h-100">
            <div class="col-6 d-flex justify-content-center img-card reset-Padding"><img
                    class="img-fluid img-resolution" id="img1" width="150" height="150"
                    src="https://aprovataf.com.br/wp-content/uploads/2016/04/Flex%C3%A3o-de-bra%C3%A7o-no-solo-AprovaTAF.jpg"
                    alt=""></div>
            <div class="col-6 d-flex flex-column justify-content-around align-items-start reset-Padding"
                style="height: 200px;">
                <div style="width: fit-content;">
                    <h6 class="reset text-start" id="category1">(Push Horizontal)</h6>
                    <h5 class="reset text-start text-uppercase" id="ValidTitle1">Flexões
                        Padrão</h5>
                </div>
                <div class="d-flex flex-column align-items-start justify-content-start">
                    <span>Num. maximo de repet.</span>
                    <input id="ValidExer1" class="input-exer text-start" type="number"
                        required="true">
                </div>
            </div>
            <div id="toggleExer1" class="d-none mb-4"><button id="btn1"
                    onclick="filter(1, 'Push', 'Horizontal')" class="btn btn-primary"
                    type="button">Trocar Exercicío</button></div>
        </div>
    </div> -->
    <!-- Sugestões de troca -->
    <!-- <div class="row d-none d-flex justify-content-center toggle-exer" > -->
    <!-- <div class="col-12 d-flex justify-content-between mb-5"
            style="border-bottom: 1px solid rgb(20, 20, 20); height: 30px !important;">


            <h4 class="mb-0">Sugestão de troca</h4>
            <i class="bi bi-x-lg "
                style="color:black; font-size: large; right: 0; cursor: pointer;"
                onclick="closer()"></i>
        </div>

        <div class=" col-6 rounded-3 bg-white my-5" style="border: 1px solid rgb(20, 20, 20);">

            <h3 class="reset" id="ValidTitle8">name</h3>
            <h4>category</h4>
            <div class="d-flex justify-content-center">
                <img width="150px" height="150px"
                    src="https://cdn.w600.comps.canstockphoto.com.br/trabalhando-dela-joelho-femininas-vetor-clip-arte_csp89802369.jpg">
            </div>
            <button onclick="subs(8, 'name', 'category', 'img')"
                class="btn btn-primary mt-2">Trocar</button>
        </div>  -->
    <!-- </div> -->



    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Sugestão de troca</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Caso nao tiver nenhum exercicio -->
                <div id="zeroExer" class="row d-none modal-body">
                    <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                        <span id="titleSugest" class="mt-2 text-center font-capt">Verificamos que não conseguiu
                            fazer o
                            exercicio de
                            NIVEL 0 da categoria</span>

                        <span class=" text-center font-capt fs-4 fw-bolder" id="categoryNull"></span>

                        <span class=" text-center font-capt"></span>

                        <span id="sugest" class=" text-center font-capt">
                            Sugerimos mudar para <strong>Treino Hibrido</strong> ou <strong>Treino de
                                Musculação</strong>
                        </span>


                    </div>
                    <div id="btnSugest" class="col-12 d-flex justify-content-around align-items-center my-3">
                        <button data-bs-dismiss="modal" class="btn btn-success w-25">Hibrido</button>
                        <button data-bs-dismiss="modal" class="btn btn-success w-25">Musculação</button>
                    </div>
                </div>

                <!-- Caso tiver algum exericio e o atual for o ultimo -->
                <div id="exerLeve" class="row d-none modal-body px-3">
                    <div class="col-12 d-flex justify-content-center align-items-center">
                        <span class="mt-2 text-center font-capt">Esse era o exercicio mais leve, mas não tem
                            problema!</span>
                    </div>
                    <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                        <span class="text-center font-capt">Verificamos que você conseguiu fazer o exercicio </span>
                        <span id="exerSameCategory" class="font-capt fw-bolder fs-4"></span>
                        <span class="text-center font-capt">então vamos fazer o seguinte:</span>
                    </div>
                    <div class="col-12 bg-success2 rounded-3 d-flex justify-content-center align-items-center">
                        <span class="mt-2 text-center font-capt">
                            Você ira progredir apenas
                            com um exercicio e
                            assim que tiver mais forte iremos sugerir um exercicio novo
                        </span>
                    </div>
                    <div class="col-12 mt-4 d-flex justify-content-center align-items-center">
                        <button id="exerLeveRemove" data-bs-dismiss="modal" class="btn btn-success w-50">OK</button>
                    </div>
                </div>

                <div class="modal-body" id="divToggle">
                    <!-- <div class="row reset-Padding my-3">
                        <div class="col-5 reset-Padding d-flex justify-content-center align-items-center">
                            <img width="125" height="125"
                                src="https://cdn.w600.comps.canstockphoto.com.br/trabalhando-dela-joelho-femininas-vetor-clip-arte_csp89802369.jpg">
                        </div>

                        <div class="col-7 d-flex align-items-center reset-Padding">
                            <div class="row reset-Padding">
                                <div class="col-12 d-flex justify-content-start align-items-center reset-Padding">
                                    <span class="reset">Knee Push Ups (de joelho)</span>
                                </div>

                                <div class="col-12 d-flex justify-content-start align-items-center reset-Padding">
                                    <span class="reset">(Push Horizontal)</span>
                                </div>

                                <div class="col-12 d-flex justify-content-center align-items-center reset-Padding W-100">
                                    <button class="btn btn-primary mt-2 " data-bs-dismiss="modal" style="width: 100%;">Trocar</button>
                                </div>
                            </div>
                        </div>

                    </div>  -->

                </div>

            </div>
        </div>
    </div>

</div>

<div id="btnGera" class="row d-none my-4">
    <!-- <div class="col-12 d-flex justify-content-center align-items-center">
        <button type="button" id="saveTraining" onclick="enviarTreino()" class="btn btn-primary">Gerar Treino</button>
    </div> -->

    <!-- <form id="form-treino" method="POST" action="/teste">
        <input class="d-none" id="check" type="button"  name="treino" value="{{treino}}">
        <button type="submit" class="btn btn-primary">Enviar Treino</button>
    </form>  -->

    <!-- <form method="POST" action="/teste">
        <input type="hidden" name="try" value="{{treino}}">
        <button type="submit">Enviar</button>
    </form> -->


    <button type="button" class="btn btn-primary" onclick="enviarTreino2()">Gerar Treino</button>

</div>

<!-- Modal de Exercicios com segundos-->
<div class="modal fade" id="toggleExerSegs" tabindex="-1" aria-labelledby="toggleExerSegsLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header d-flex justify-content-center align-items-center">
                <span class="text-center text-uppercase font-title-modal fw-bold" id="toggleExerSegsLabel">Seu
                    exercicio
                    está pesado!</span>
            </div>
            <div class="modal-body">
                <div class="row reset-Padding">
                    <div class="col-12 d-flex justify-content-center align-items-center">
                        <span class="text-center font-title-modal">Sugerimos excluir o exercicio </span>
                    </div>
                    <div class="col-12 d-flex justify-content-center align-items-cente">
                        <span id="exerDeleter" class="text-center fw-bolder text-uppercase"></span>
                    </div>
                    <div class="col-12 mt-3 d-flex flex-column justify-content-center align-items-cente">
                        <span class="mt-2 text-center font-capt">
                            Você terá que fazer muitas séries de
                            <span id="nameExer" class="fw-bolder text-uppercase"></span> e por isso ele pode valer
                            por 2
                            exercícios ao mesmo tempo.
                        </span>
                        <span class="mt-2 text-center font-capt text-danger">
                            Se não quiser excluir, terá que excolher um mais fácil para diminuir o numero de
                            séries.
                        </span>
                    </div>
                </div>
            </div>


            <div class="modal-footer d-flex justify-content-center">
                <button id="removeExer" data-bs-dismiss="modal" class="btn btn-success">Excluir</button>
                <button id="notRemove" data-bs-dismiss="modal" class="btn btn-success">Não Excluir</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Paired Sets-->
<div class="modal fade" id="pairedSets" tabindex="-1" aria-labelledby="pairedSetsLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h1 class="modal-title fs-5" id="pairedSetsLabel">O que é Paired Sets?</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <span>
                    Os paired sets é uma técnica de treinamento em que realizamos exercícios de grupos musculares
                    diferentes em sequência, com um descanso mais curto entre eles do que o usual. Por exemplo, se
                    você
                    fizer um exercício para o peito, seguido de um exercício para as costas, em vez de descansar
                    completamente entre os dois, você descansaria apenas metade do tempo usual. Essa técnica ajuda a
                    aumentar a intensidade do treino e pode ser uma ótima maneira de otimizar o tempo.
                </span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<audio id="myAudio">
    <source src="assets/audio/not.mp3" type="audio/mp3">
</audio>

<script>
    const exercises = giveExer()
    const exercisesBase = exercises.filter(e => e.default == true)
    const div2 = document.getElementById('div2');
    var treino = []
    var newExercises = []
    var newExercisesBase = []
    var requireds = []
    var numberInput = [1, 2, 3, 4, 5, 6, 7, 8]


    function creatExercisesBase() {
        //Esconde
        const quiz = document.getElementById('quiz')
        quiz.classList.add('d-none')


        const btnGera = document.getElementById('btnGera')
        btnGera.classList.remove('d-none')
        // Div onde sera add os exercicios
        const divPai2 = document.getElementById('div2')
        var x = 1
        divPai2.classList.remove('d-none')



        newExercisesBase.forEach(exer => {

            if (exer == undefined) {
                return
            }
            // Criação da nova div
            var novaDiv = document.createElement("div");
            novaDiv.id = "exer" + x;
            novaDiv.className = "col-lg-5 position-relative col-11 d-flex justify-content-center align-items-center rounded-3 p-2 m-2 bg-white";
            novaDiv.style.border = "1px solid rgb(163, 163, 163)";

            // Criação do conteúdo da div
            novaDiv.innerHTML = `
            <div class="row position-relative">
              <div class="col-3 d-flex justify-content-center align-items-center">
                <img class="rounded-4" id="${'img' + x}" width="68" height="68"
                  src="${exer.url}"
                  alt="">
              </div>
      
              <div class="col-9 d-flex align-items-center ps-3 pe-5">
                <div class="row">
                  <div class="col-12 reset-Padding">
                    <input type="hidden" id=${'nivel' + x} name="nivel" value="${exer.nivel}">
                    <span id=${'ValidTitle' + x} class="reset text-uppercase" style="font-size: 18px;">${exer.name}</span>
                  </div>
      
                  <div class="col-4 d-flex flex-column justify-content-center align-items-start my-2 reset-Padding">
                    <p class="reset text-uppercase text-gray1">SÉRIE</p>
                    <input class="w-75 text-center rounded-3" type="text" placeholder="1" disabled>
                  </div>
      
                  <div class="col-4 d-flex flex-column justify-content-center align-items-center reset-Padding">
                    <p id="${'repts' + x}" class="reset text-uppercase text-gray1">${exer.segs ? 'SEGS' : 'REPS'}</p>
                    <input pattern="^-?\d*\.?\d+$" inputmode="numeric" required="true" id="${'ValidExer' + x}" class="w-75 input-value text-center rounded-3" type="number">
      
                  </div>
      
                  <div class="col-4 d-flex flex-column justify-content-center align-items-end reset-Padding">
                    <p class="reset text-uppercase text-gray1">PAUSA</p>
                    <input id="cronometro${x}" required="true" disabled placeholder="3min" class="w-75 input-value text-center rounded-3" type="text">
                  </div>
                </div>
      
                 <!--<i class="bi bi-three-dots-vertical position-absolute top-0 end-0 "></i>-->
              </div>
      
              <div id="${'toggleExer' + x}"class="col-12 d-none d-flex flex-column justify-content-center">
      
                <button id="${'btn' + x}" onclick="filter(${x}, '${exer.name}', '${exer.category}', '${exer.type}', ${exer.nivel})" class="btn btn-primary mb-2 w-100" data-bs-toggle="modal" data-bs-target="#exampleModal">Trocar Exercicío</button>
                  
                </button>
      
                  <span id="${'heavy' + x}" class="reset text-danger text-start px-2 d-none" style="font-size: 10px;">
                          *Ops, sua quantidade de ${exer.segs ? 'segundos' : 'repetição'} está baixa! Vamos trocar para um mais leve?
                      </span>
      
                       <span id="${'light' + x}" class="reset text-danger text-start px-2 d-none" style="font-size: 10px;">
                          *Ops, sua quantidade de ${exer.segs ? 'segundos' : 'repetição'} está  alta! Vamos trocar para um mais pesado?
                      </span> 
      
                      </div>
                      <span id="${'success' + x}" class="reset px-3 text-start text-success d-none" style="font-size: 10px;">
                      Perfeito, agora é só descansar e fazer o próximo exercício
                      </span> 
      
                      <span id="${'noInput' + x}" class="reset px-3 text-start text-danger d-none" style="font-size: 10px;">
                      Por favor, insira o numero máximo de ${exer.segs ? 'segundos' : 'repetição'}, para montarmos seu treino.
                      </span> 
            </div>`;
            x += 1
            divPai2.appendChild(novaDiv)
        })

        // Criando as verificações "Blur"
        for (let i = 1; i < newExercisesBase.length + 1; i++) {
            creatStruct(i)
        }

    }

    function getImgUrl(name) {
        const exercise = exercises.find(e => e.name === name);
        return exercise.url;
    }

    function filter(id, name, category, type, nivel) {

        // Mescla os dados entre os arrays
        let arrayCorrecty = correctingArray(treino, exercises)
        // Procura no array de exercicios qual é o que vai ser alterado
        let exerFound = exercises.filter(e => e.name == name)

        let filterType


        const divHidden = document.getElementById('divToggle')
        divHidden.classList.remove('d-none')
        divHidden.classList.add('d-block')

        const inputValue = document.getElementById('ValidExer' + id)
        let input = parseInt(inputValue.value)


        nivel = exerFound[0].nivel
        let segs = exerFound[0].segs
        // Verifica se o exercicio precisa tratar segundos
        if (segs) {
            //input 18s
            let segundos = input / 2 //9s
            let repeticao = 60 / segundos // 6 reptes
            let sugundosTotais = segundos * repeticao // 54segundos totais
            if (repeticao == 5 || repeticao == 6) {

            }
            if (repeticao > 6 || input <= 60) {
                nivel -= 1
            }
            if (repeticao < 2) {
                nivel += 1
            }

        }
        else {

            if (input != null) {
                input == 0 || input <= 2 ? nivel -= 2 : null;

                input >= 3 && input <= 5 ? nivel -= 1 : null;

                input >= 6 && input <= 15 ? nivel : null  // valor ser mostrado default

                input > 15 && input <= 25 ? nivel += 1 : null;

                input > 25 && input <= 40 ? nivel += 2 : null;

                nivel > 6 ? nivel = 6 : nivel = nivel

                nivel < 0 ? nivel = 0 : nivel = nivel
            }

        }


        if (category) {
            filterType = newExercises.filter(exercise => exercise.category === category);
        }
        // Filtra os exercícios com base no nível, se o nível for especificado
        if (nivel !== undefined && nivel >= 0) {
            filterType = filterType.filter(exercise => exercise.nivel === nivel);
        }
        // Filtra os exercícios com base no tipo, se o tipo for especificado
        if (type) {
            filterType = filterType.filter(exercise => exercise.type === type);
        }


        // Retira exercicios repetidos
        let filtered = filterType.filter((item, index, arr) => {
            return arr.findIndex(t => t.name === item.name) === index;
        });
        filterType = filtered;

        // Retira os exercicios que estão no newExercisesBase
        let altered = [];
        filterType.forEach(e => {
            if (!newExercisesBase.find(i => i.name === e.name)) {
                altered.push(e);
            }
        });
        filterType = altered;


        // Retira todos os exercicios com o nome do que está subistituindo
        filterType = filterType.filter(e => e.name !== exerFound[0].name);

        if (filterType.length < 1) {
            const zeroExer = document.getElementById('zeroExer')
            zeroExer.classList.add('d-none')
            const exerLeve = document.getElementById('exerLeve')
            exerLeve.classList.add('d-none')

            let exerSameCategory = arrayCorrecty.filter(e => e.category == exerFound[0].category && e.name != exerFound[0].name)


            // Se não tiver outro exercicio no treino 
            if (exerSameCategory.length > 0) {
                //Mostrar messagem que só tera esse exercicio até ele evoluir o suficiente para fazer outro exercicio
                const exerLeve = document.getElementById('exerLeve')
                exerLeve.classList.remove('d-none')

                const ESC = document.getElementById('exerSameCategory')
                ESC.innerHTML = exerSameCategory[0].name

                const titleModal = document.getElementById('exampleModalLabel')
                titleModal.innerHTML = 'Atenção'
                titleModal.classList.add('fw-bolder')

                const exerLeveRemove = document.getElementById('exerLeveRemove')
                exerLeveRemove.onclick = function () { removeExer(exerFound) };

            }
            else {
                // Identificamos qual é o outro exercicio da mesma categoria
                let otherExerSameCategory = newExercisesBase.filter(e => e.category == exerFound[0].category && e.name != exerFound[0].name)[0]
                // descobrimos o index dele
                let index = newExercisesBase.findIndex(e => e.name == otherExerSameCategory.name)
                // Atraves do index puxamos o valor do input
                const inputExer = document.getElementById('ValidExer' + (index + 1))
                // Verificamos se o botão está aparecendo
                const toggleExer = document.getElementById('toggleExer' + (index + 1))



                const btnSugest = document.getElementById('btnSugest')
                const titleSugest = document.getElementById('titleSugest')
                const categoryNull = document.getElementById('categoryNull')
                const sugest = document.getElementById('sugest')

                // Verifica se o exercicio de mesma categoria está vazio
                if (inputExer.value == "") {
                    btnSugest.classList.add('d-none')
                    sugest.classList.add('d-none')
                    categoryNull.classList.add('d-none')

                    titleSugest.innerHTML = `Sugerimos tentar fazer o <strong>${otherExerSameCategory.name}</strong> antes de fazer a troca desse exercicio`

                }
                // Se estiver preenchido e não for valido
                else {
                    if (inputExer.value != "" && toggleExer.classList.contains('d-none')) {
                        btnSugest.classList.add('d-none')
                        categoryNull.classList.add('d-none')
                        sugest.classList.remove('d-none')

                        titleSugest.innerHTML = `Verificamos que você conseguiu fazer o ${otherExerSameCategory.name}. E este exercicio que você está tentando trocar é o de nivel 0 (Não tem exercicio mais fraco)`

                        sugest.innerHTML = `Sugerimos que mantenha apenas com 1 exercicio da categoria ${otherExerSameCategory.category}`
                    }
                    // Se estiver preenchido e for valido
                    else {

                        btnSugest.classList.remove('d-none')
                        sugest.classList.remove('d-none')


                        titleSugest.innerHTML = `Verificamos que não conseguiu fazer os exercicios de NIVEL 0 da categoria <strong>${exerFound[0].category}</strong> (${otherExerSameCategory.name} e ${exerFound[0].name})</span>`


                        sugest.innerHTML = 'Sugerimos mudar para <strong>Treino Hibrido</strong> ou <strong>Treino de Musculação</strong>'

                    }
                }




                const zeroExer = document.getElementById('zeroExer')
                zeroExer.classList.remove('d-none')

                const zeroEcategoryNullxer = document.getElementById('categoryNull')
                zeroEcategoryNullxer.innerHTML = exerFound[0].category


            }
        }
        else {

            const divPai = document.getElementById('divToggle')
            divPai.innerHTML = ''
            var x = 1
            filterType.forEach(e => {
                // cria o primeiro elemento
                const div1 = document.createElement('div');
                div1.classList.add('row', 'reset-Padding', 'my-3');

                // cria o segundo elemento
                const div2s = document.createElement('div');
                div2s.classList.add('col-5', 'reset-Padding', 'd-flex', 'justify-content-center', 'align-items-center');

                // cria o terceiro elemento
                const img = document.createElement('img');
                img.setAttribute('width', '115');
                img.setAttribute('height', 'auto');
                img.setAttribute('src', e.url);

                // adiciona o terceiro elemento ao segundo elemento
                div2s.appendChild(img);

                // cria o quarto elemento
                const div3 = document.createElement('div');
                div3.classList.add('col-7', 'd-flex', 'align-items-center', 'reset-Padding');

                // cria o quinto elemento
                const div4 = document.createElement('div');
                div4.classList.add('row', 'reset-Padding');
                div4.id = 'row' + x
                // cria o sexto elemento
                const div5 = document.createElement('div');
                div5.classList.add('col-12', 'd-flex', 'justify-content-start', 'align-items-center', 'reset-Padding');

                // cria o sétimo elemento
                const span1 = document.createElement('span');
                span1.classList.add('reset');
                span1.textContent = e.name;

                // adiciona o sétimo elemento ao sexto elemento
                div5.appendChild(span1);

                // adiciona o sexto elemento ao quinto elemento
                div4.appendChild(div5);

                // cria o oitavo elemento
                const div6 = document.createElement('div');
                div6.classList.add('col-12', 'd-flex', 'justify-content-start', 'align-items-center', 'reset-Padding');

                // cria o nono elemento
                const span2 = document.createElement('span');
                span2.classList.add('reset');
                span2.textContent = `(${e.category} ${e.type})`;

                // adiciona o nono elemento ao oitavo elemento
                div6.appendChild(span2);

                // adiciona o oitavo elemento ao quinto elemento
                div4.appendChild(div6);

                // cria o décimo elemento
                const div7 = document.createElement('div');
                div7.classList.add('col-12', 'd-flex', 'justify-content-center', 'align-items-center', 'reset-Padding', 'W-100');

                // cria o décimo primeiro elemento
                const button = document.createElement('button');
                button.onclick = function () { subs(id, e.name, e.category, e.type, e.url, e.nivel) };
                button.id = 'toggle' + x
                button.className = 'btn btn-primary mt-2';
                button.innerText = 'Trocar';
                button.classList.add('btn', 'btn-primary', 'mt-2');
                button.setAttribute('data-bs-dismiss', 'modal');
                button.setAttribute('style', 'width: 100%');
                button.textContent = 'Trocar';

                // adiciona o décimo primeiro elemento ao décimo elemento
                div7.appendChild(button);

                // adiciona o quinto e o décimo elemento ao quarto elemento
                div4.appendChild(div5);
                div4.appendChild(div6);
                div4.appendChild(div7);

                // adiciona o segundo e o quarto elemento ao terceiro elemento
                div3.appendChild(div4);

                // adiciona o segundo e o terceiro elemento ao primeiro elemento
                div1.appendChild(div2s);
                div1.appendChild(div3);

                // adiciona o primeiro elemento ao elemento pai
                divPai.appendChild(div1);
                x++
            })

        }

    }

    function subs(id, name, category, type, img, nivel) {
        const Name = document.getElementById('ValidTitle' + id)
        const Img = document.getElementById('img' + id)
        const div = document.getElementById('toggleExer' + id)
        const input = document.getElementById('ValidExer' + id)
        const repts = document.getElementById('repts' + id)

        // var newArray = []
        // newExercisesBase.forEach(e => {
        //   if (e == undefined) {
        //     return
        //   }
        //   newArray.push(e)
        // })

        var nameExer = exercises.filter(e => e.name == name)
        // Subistituir no array
        let indexExer = newExercisesBase.findIndex(e => e.name == Name.innerHTML)
        if (indexExer != -1) {
            newExercisesBase[indexExer] = nameExer[0]
        }

        if (nameExer[0].segs) {
            repts.innerHTML = 'SEGS'
        }
        else {
            repts.innerHTML = 'REPS'
        }

        // zerar a div do botão
        div.innerHTML = ''

        div.innerHTML = `<button id="${'btn' + id}" onclick="filter(${id}, '${name}', '${category}', '${type}', ${nivel})" class="btn btn-primary mb-2 w-100" data-bs-toggle="modal" data-bs-target="#exampleModal">Trocar Exercicío</button>
        <span id="${'heavy' + id}" class="reset text-danger text-start px-2 d-none" style="font-size: 10px;">
        *Ops, sua quantidade de ${nameExer[0].segs ? 'segundos' : 'repetição'} está baixa! Vamos trocar para um mais leve?
        </span>
      
        <span id="${'light' + id}" class="reset text-danger text-start px-2 d-none" style="font-size: 10px;">
          *Ops, sua quantidade de ${nameExer[0].segs ? 'segundos' : 'repetição'} está alta! Vamos trocar para um mais pesado?
        </span> 
      
        </div>
        <span id="${'success' + id}" class="reset px-3 text-start text-success d-none" style="font-size: 10px;">
        Perfeito, agora é só descansar ${nameExer[0].rest}m e fazer o próximo exercício
        </span> 
        `

        // Trocando o exercicio
        Name.innerHTML = name
        Img.src = img

        // Esconde o button
        const btn = document.getElementById('toggleExer' + id)
        btn.classList.add('d-none')
        btn.classList.remove('d-block')

        // Zerar input
        input.value = ''

        input.classList.remove('text-danger')
        input.classList.remove('input-exer')
        input.classList.remove('input-danger')
        input.classList.remove('input-exer-fail')

        input.classList.add('input-exer')
        input.classList.add('input-value')

        repts.classList.remove('text-danger')
        repts.classList.add('text-gray1')


    }

    function openToggleExer(id, Title, Input, bool) {
        const input = document.getElementById('ValidExer' + id);
        const btn = document.getElementById('toggleExer' + id)
        const light = document.getElementById('light' + id)
        const heavy = document.getElementById('heavy' + id)
        const repts = document.getElementById('repts' + id)
        const success = document.getElementById('success' + id)
        const noInput = document.getElementById('noInput' + id)

        var exer = exercises.filter(e => e.name == Title.innerHTML)
        // Se for segs
        if (exer[0].segs) {
            // Se o exercicio nao for de segundos ira executar essa validação

            let segundos = input.value / 2 //Resposta em segundos
            let repeticao = 60 / Math.round(segundos) // Repostas em repetição
            repeticao = Math.round(repeticao)
            let sugundosTotais = segundos * repeticao // Segundos totais do exer

            // Dentro dos parametros
            if (repeticao <= 4 && input.value < 60) {
                // if (bool) {
                noInput.classList.add('d-none')
                success.classList.remove('d-none')
                // Tempo da message de sucesso
                setTimeout(function () {
                    success.classList.add("d-none");
                }, 180000);
                // }
                input.classList.remove('text-danger')
                input.classList.remove('input-danger')

                repts.classList.remove('text-danger')
                repts.classList.add('text-gray1')

                btn.classList.add('d-none')
                btn.classList.remove('d-block')

                let card = parseInt(id)
                desabilitCard(card)
                gerarTreino(Title, Input, id)
            }
            // Se o numero de repetição for 5 ou 6 mostra o modal
            if (repeticao == 5 || repeticao == 6) {
                noInput.classList.add('d-none')
                //  dar opção de eliminar exercicio
                var modal = new bootstrap.Modal(document.querySelector('#toggleExerSegs'));

                // Pegar nome do exer que ira ser deletado
                let exerRemove = newExercisesBase.filter(e => e.category == exer[0].category && e.name != exer[0].name)

                // Imprimir na tela
                const exerDeletr = document.getElementById('exerDeleter')
                exerDeletr.innerHTML = exerRemove[0].name

                // Imprimir nome do exercicio que está pesado
                const name = document.getElementById('nameExer')
                name.innerHTML = exer[0].name



                var fixArray = []
                newExercisesBase.forEach(e => {
                    if (e == undefined) {
                        return
                    }
                    fixArray.push(e)
                })

                var countCategory = fixArray.filter(e => e.category == exer[0].category)

                if (countCategory.length == 1) {
                    // Mostra o botão de trocar o exercicio
                    btn.classList.add('d-block')
                    btn.classList.remove('d-none')
                }
                else {
                    // filtra por categori e pega o outro exercicio da mesma catagoria
                    let exerRemove = newExercisesBase.filter(e => e.category == exer[0].category && e.name != exer[0].name)

                    btn.classList.add('d-none')

                    const btnremove = document.getElementById('removeExer')
                    btnremove.onclick = function () { removeExer(exerRemove, id, Title, Input, exer) };

                    // Exibir o modal
                    modal.show();

                    const notRemove = document.getElementById('notRemove')
                    notRemove.onclick = function () { showBtn(btn) }
                }

            }
            // Se for maior que 6 mostra messagem de erro PESADO
            if (repeticao > 6 || input.value >= 60) {
                noInput.classList.add('d-none')
                // Texto de sucesso some
                success.classList.add('d-none')

                // Mostra o botão de trocar o exercicio
                btn.classList.add('d-block')
                btn.classList.remove('d-none')

                //Mostra a obs de exer leve
                light.classList.add('d-block')
                light.classList.remove('d-none')

                //Oculta a obs de exer pesado
                heavy.classList.add('d-none')
                heavy.classList.remove('d-block')

                //Add visuald e erro
                input.classList.add('text-danger')
                input.classList.add('input-danger')

                repts.classList.add('text-danger')
                repts.classList.remove('text-gray1')
            }
            // Leve
            if (repeticao < 2) {
                noInput.classList.add('d-none')
                // Texto de sucesso some
                success.classList.add('d-none')

                // Mostra o botão de trocar o exercicio
                btn.classList.add('d-block')
                btn.classList.remove('d-none')

                //Mostra a obs de exer leve
                light.classList.add('d-block')
                light.classList.remove('d-none')

                //Oculta a obs de exer pesado
                heavy.classList.add('d-none')
                heavy.classList.remove('d-block')

                //Add visuald e erro
                input.classList.add('text-danger')
                input.classList.add('input-danger')

                repts.classList.add('text-danger')
                repts.classList.remove('text-gray1')
            }


        }
        // Se for repts
        else {
            if (exer[0].name == 'Dips na paralela' || exer[0].name == 'Pull Ups') {
                if (input.value <= 3) {
                    noInput.classList.add('d-none')
                    // Texto de sucesso some
                    success.classList.add('d-none')

                    // Mostra o botão de trocar o exercicio
                    btn.classList.add('d-block')
                    btn.classList.remove('d-none')

                    //Mostra a obs de exer pesado
                    heavy.classList.add('d-block')
                    heavy.classList.remove('d-none')

                    //Oculta a obs de exer leve
                    light.classList.add('d-none')
                    light.classList.remove('d-block')

                    //Add visuald e erro
                    input.classList.add('text-danger')
                    input.classList.add('input-danger')

                    repts.classList.add('text-danger')
                    repts.classList.remove('text-gray1')

                }
                if (input.value > 3 && input.value < 16) {

                    let card = parseInt(id)
                    desabilitCard(card)

                    noInput.classList.add('d-none')
                    if (bool) {
                        success.classList.remove('d-none')
                        // Tempo da message de sucesso
                        setTimeout(function () {
                            success.classList.add("d-none");
                        }, 180000);
                    }
                    input.classList.remove('text-danger')
                    input.classList.remove('input-danger')

                    repts.classList.remove('text-danger')
                    repts.classList.add('text-gray1')

                    btn.classList.add('d-none')
                    btn.classList.remove('d-block')
                    gerarTreino(Title, Input, id)

                    const divPai = document.getElementById('divToggle')
                    divPai.innerHTML = ''
                    if (treino.length === 8) {
                        // fechar model
                        // const button = document.getElementById('saveTraining')
                        // button.setAttribute('data-bs-dismiss', 'modal')
                    }
                }
                if (input.value > 15) {
                    noInput.classList.add('d-none')
                    // Texto de sucesso some
                    success.classList.add('d-none')

                    // Mostra o botão de trocar o exercicio
                    btn.classList.add('d-block')
                    btn.classList.remove('d-none')

                    //Mostra a obs de exer leve
                    light.classList.add('d-block')
                    light.classList.remove('d-none')

                    //Oculta a obs de exer pesado
                    heavy.classList.add('d-none')
                    heavy.classList.remove('d-block')

                    //Add visuald e erro
                    input.classList.add('text-danger')
                    input.classList.add('input-danger')

                    repts.classList.add('text-danger')
                    repts.classList.remove('text-gray1')
                }
            }
            else {
                if (input.value < 6) {
                    noInput.classList.add('d-none')

                    // Texto de sucesso some
                    success.classList.add('d-none')

                    // Mostra o botão de trocar o exercicio
                    btn.classList.add('d-block')
                    btn.classList.remove('d-none')

                    //Mostra a obs de exer pesado
                    heavy.classList.add('d-block')
                    heavy.classList.remove('d-none')

                    //Oculta a obs de exer leve
                    light.classList.add('d-none')
                    light.classList.remove('d-block')

                    //Add visuald e erro
                    input.classList.add('text-danger')
                    input.classList.add('input-danger')

                    repts.classList.add('text-danger')
                    repts.classList.remove('text-gray1')

                }
                if (input.value > 5 && input.value < 16) {

                    let card = parseInt(id)
                    desabilitCard(card)
                    noInput.classList.add('d-none')
                    if (bool) {
                        success.classList.remove('d-none')
                        let divExer = document.getElementById('exer' + id)
                        // Tempo da message de sucesso
                        setTimeout(function () {
                            success.classList.add("d-none");
                        }, 180000);
                    }


                    input.classList.remove('text-danger')
                    input.classList.remove('input-danger')

                    repts.classList.remove('text-danger')
                    repts.classList.add('text-gray1')

                    btn.classList.add('d-none')
                    btn.classList.remove('d-block')
                    gerarTreino(Title, Input, id)

                    const divPai = document.getElementById('divToggle')
                    divPai.innerHTML = ''
                    if (treino.length === 8) {
                        // fechar model
                        // const button = document.getElementById('saveTraining')
                        // button.setAttribute('data-bs-dismiss', 'modal')
                    }
                }
                if (input.value > 15) {
                    // Texto de sucesso some
                    noInput.classList.add('d-none')
                    success.classList.add('d-none')

                    // Mostra o botão de trocar o exercicio
                    btn.classList.add('d-block')
                    btn.classList.remove('d-none')

                    //Mostra a obs de exer leve
                    light.classList.add('d-block')
                    light.classList.remove('d-none')

                    //Oculta a obs de exer pesado
                    heavy.classList.add('d-none')
                    heavy.classList.remove('d-block')

                    //Add visuald e erro
                    input.classList.add('text-danger')
                    input.classList.add('input-danger')

                    repts.classList.add('text-danger')
                    repts.classList.remove('text-gray1')
                }
            }
        }


    }

    function addColorError() {
        for (let i = 1; i < newExercisesBase.length + 1; i++) {
            const input = document.getElementById('ValidExer' + i)
            const title = document.getElementById('ValidTitle' + i)
            const repts = document.getElementById('repts' + i)
            const light = document.getElementById('light' + i)
            const heavy = document.getElementById('heavy' + i)
            const noInput = document.getElementById('noInput' + i)


            if (input.value == NaN || input.value == null || input.value == undefined || input.value == "") {
                // Se o input estiver vazio add as classes 
                input.classList.remove('input-exer')
                input.classList.add('input-exer-fail')
                repts.classList.add('text-danger')

                // setTimeout(function () {
                noInput.classList.remove('d-none')
                // }, 180000);
            } else {
                // Se estiver preenchido
                noInput.classList.add('d-none')
                input.classList.add('input-exer')
                input.classList.remove('input-exer-fail')
                repts.classList.remove('text-danger')
                // title.classList.remove('text-danger')

                openToggleExer(i, title, input, false)
            }

        }
    }

    function removeColorError() {
        const input = document.getElementById('ValidExer' + id)
        const title = document.getElementById('ValidTitle' + id)
        const repts = document.getElementById('repts' + id)

        input.classList.add('input-exer')
        input.classList.remove('input-exer-fail')
        repts.classList.remove('text-danger')
        title.classList.remove('text-danger')
    }

    function creatStruct(id) {
        const input = document.getElementById('ValidExer' + id)
        const title = document.getElementById('ValidTitle' + id)
        const repts = document.getElementById('repts' + id)

        input.addEventListener('blur', function () {
            if (input.value == NaN ||
                input.value == null ||
                input.value == undefined ||
                input.value == "") {

                input.classList.remove('input-exer')
                input.classList.add('input-exer-fail')
                repts.classList.add('text-danger')
            } else {
                repts.classList.remove('text-danger')
                input.classList.remove('input-exer-fail')
                input.classList.add('input-exer')
                openToggleExer(id, title, input, true)
            }
        })
    }

    function gerarTreino(title, input, id) {
        // Cria um novo objeto com as informações do exercício
        const exer = getImgUrl(title.innerHTML)
        let novoExercicio = {}
        var valueInput = parseInt(input.value)

        let exerFound = exercises.filter(e => e.name == title.innerHTML)[0]

        let segundos = Math.round(valueInput / 2)//Resposta em segundos
        let repeticao = Math.round(60 / segundos) // Repostas em repetição


        if (exerFound.segs) {
            // add no treino, com as regras de segundos
            novoExercicio = { name: title.innerHTML, count: segundos, rept: repeticao, rest: 3, url: exer, num: id, segs: "true" };
        }
        else {
            if (title.innerHTML == "Dips na paralela" || title.innerHTML == "Pull Ups") {

                if (valueInput == 3 || valueInput == 4 || valueInput == 5) {
                    if (valueInput == 3) {
                        novoExercicio = { name: title.innerHTML, count: (valueInput - 1), rept: 5, rest: 3, url: exer, num: id };
                    }
                    if (valueInput == 4) {
                        novoExercicio = { name: title.innerHTML, count: (valueInput - 1), rept: 5, rest: 3, url: exer, num: id };
                    }
                    if (valueInput == 5) {
                        novoExercicio = { name: title.innerHTML, count: (valueInput - 1), rept: 4, rest: 3, url: exer, num: id };
                    }
                }
                else {
                    novoExercicio = { name: title.innerHTML, count: (valueInput - 1), rept: 3, rest: 3, url: exer, num: id };
                }
            }
            else {
                novoExercicio = { name: title.innerHTML, count: (valueInput - 1), rept: 3, rest: 3, url: exer, num: id };
            }
        }

        const found = treino.findIndex(e => e.name == novoExercicio.name)
        if (found !== -1) {

            if (exerFound.segs) {
                // add no treino, com as regras de segundos
                treino[found].rept = repeticao
                treino[found].count = segundos
            }
            else {
                if (treino[found].name == "Dips na paralela" || treino[found].name == "Pull Ups") {

                    if (valueInput == 3 || valueInput == 4 || valueInput == 5) {
                        if (valueInput == 3) {
                            treino[found].rept = 5
                            treino[found].count = (valueInput - 1)
                        }
                        if (valueInput == 4) {
                            treino[found].rept = 5
                            treino[found].count = (valueInput - 1)
                        }
                        if (valueInput == 5) {
                            treino[found].rept = 4
                            treino[found].count = (valueInput - 1)
                        }
                    }
                    else {
                        treino[found].rept = 3
                        treino[found].count = (valueInput - 1)
                    }
                }
                else {
                    treino[found].rept = 3
                    treino[found].count = (valueInput - 1)
                }
            }
        } else {
            treino.push(novoExercicio);
            console.log(treino)
        }
    }

    function validationQtdExer() {
        var filterCategory = []

        treino.forEach(e => {
            var aux = exercises.filter(i => i.name == e.name)
            filterCategory.push(aux)
        })

        var Push = filterCategory.flat().filter(e => e.category == 'Push')
        var Pull = filterCategory.flat().filter(e => e.category == 'Pull')
        var Core = filterCategory.flat().filter(e => e.category == 'Core')
        var Legs = filterCategory.flat().filter(e => e.category == 'Legs')

        if (Push.length == 1) {
            // Procura no treino qual é o index do exercicio que precisa ser alterado
            let indexName = treino.findIndex(e => e.name == Push[0].name)
            // Atualiza o count = 5 e rept = (total -2)
            if (indexName !== -1) {
                treino[indexName].rept = 5
                treino[indexName].count -= 1
            } else {
            }
        }

        if (Pull.length == 1) {
            // Procura no treino qual é o index do exercicio que precisa ser alterado
            let indexName = treino.findIndex(e => e.name == Pull[0].name)
            // Atualiza o count = 5 e rept = (total -2)
            if (indexName !== -1) {
                treino[indexName].rept = 5
                treino[indexName].count -= 1
            } else {
            }
        }

        if (Core.length == 1) {
            // Procura no treino qual é o index do exercicio que precisa ser alterado
            let indexName = treino.findIndex(e => e.name == Core[0].name)
            // Atualiza o count = 5 e rept = (total -2)
            if (indexName !== -1) {
                treino[indexName].rept = 5
                treino[indexName].count -= 1
            } else {
            }
        }

        if (Legs.length == 1) {
            // Procura no treino qual é o index do exercicio que precisa ser alterado
            let indexName = treino.findIndex(e => e.name == Legs[0].name)
            // Atualiza o count = 5 e rept = (total -2)
            if (indexName !== -1) {
                treino[indexName].rept = 5
                treino[indexName].count -= 1
            } else {
            }
        }


    }

    function removeExer(exer, id, Title, Input, exerRestante) {
        // Remove o exercicio do array

        var treino2 = []
        newExercisesBase.forEach(e => {
            if (e == undefined) {
                return
            }
            treino2.push(e)
        })

        let index = treino2.findIndex(e => e.name === exer[0].name);
        if (index !== -1) {
            treino2.splice(index, 1); //remova o elemento com o índice encontrado
        }

        let treinoDel = treino.findIndex(e => e.name === exer[0].name)
        if (treinoDel !== -1) {
            treino.splice(treinoDel, 1); //remova o elemento com o índice encontrado
        }
        // ---------------------------------------------------------------------
        // remove visualmente o exer
        var x = 1
        newExercisesBase.forEach(e => {
            if (e == undefined) {
                return
            }
            if (e.name == exer[0].name) {
                const divRemove = document.getElementById('exer' + x)
                divRemove.remove()
            }
            x++
        })
        newExercisesBase = treino2
        if (Title) {
            gerarTreino(Title, Input, id)
        }

        if (exerRestante) {
            let index = newExercisesBase.findIndex(e => e.name == exerRestante[0].name)

            let input = document.getElementById('ValidExer' + (index + 1))
            input.classList.remove('input-danger')
            input.classList.remove('text-danger')
        }
        return newExercisesBase; //retorne o array atualizado
    }

    function openModal(id) {
        var modal = new bootstrap.Modal(document.querySelector(`#${id}`));
        modal.show()
    }

    function showBtn(btn) {
        btn.classList.add('d-block')
        btn.classList.remove('d-none')
    }

    function correctingArray(treino, exercicio) {
        let data_all = [];

        exercicio.forEach(a => {
            treino.forEach(t => {
                if (a["name"] == t["name"]) {
                    let new_data = Object.assign({}, a, t);
                    data_all.push(new_data);
                }
            });
        });
        return data_all
    }

    function desabilitCard(id) {
        const audio = document.getElementById("myAudio");

        // Monta o array de id sem o id que está sendo tratado
        let cardAtual = numberInput.findIndex(e => e == id)
        if (cardAtual != -1) {
            numberInput.splice(cardAtual, 1);
        }
        // Desabilita todos os inpust e add uma class aos cards
        numberInput.forEach(e => {
            const inputDesabilit = document.getElementById('ValidExer' + e)
            if (inputDesabilit != null) {
                inputDesabilit.disabled = true;
            }
            const divExer = document.getElementById('exer' + e)
            if (divExer != null) {
                divExer.classList.add('desabilited')
            }

        })
        let meuInput = document.getElementById('ValidExer' + id);
        let cronometro = document.getElementById('cronometro' + id);
        let segundosRestantes = 180; // 3 minutos em segundos
        let interval; // Declarando a variável fora da função para poder usar em outro escopo


        clearInterval(interval); // Parar o cronômetro se ele já estiver rodando
        segundosRestantes = 180; // Reiniciar o tempo
        cronometro.placeholder = "3:00"

        interval = setInterval(function () {
            segundosRestantes--;
            let minutos = Math.floor(segundosRestantes / 60);
            let segundos = segundosRestantes % 60;
            cronometro.placeholder = minutos + "m " + segundos + "s";

            if (segundosRestantes <= 0) {
                audio.play()
                clearInterval(interval); // Parar o cronômetro
                meuInput.disabled = false; // Habilitar input
                cronometro.placeholder = "fim";

                const menssagemSuccess = document.getElementById('success' + id)
                menssagemSuccess.classList.add('d-none')
                
                const exerFinish = document.getElementById('exer' + id)
                exerFinish.classList.remove('bg-white')
                exerFinish.classList.add('exerFinish')

                numberInput.forEach(e => {
                    const inputDesabilit = document.getElementById('ValidExer' + e)
                    if (inputDesabilit != null){
                        inputDesabilit.disabled = false;
                    }
                    const divExer = document.getElementById('exer' + e)
                    if (divExer != null){
                        divExer.classList.remove('desabilited')
                    }  
                })
            }
        }, 1); // Atualizar o cronômetro a cada segundo

    }

    // Obtém o elemento do carrossel e seus itens internos
    const quizCarousel = document.querySelector('#quiz');
    const quizItems = quizCarousel.querySelectorAll('.carousel-item');
    const hours = document.getElementById('hours')
    const min = document.getElementById('min')
    const days = document.getElementById('days')

    const timeErr = document.getElementById('timeErr')

    // Percorre cada item do quiz e adiciona um evento de clique em seus inputs de opção
    quizItems.forEach(item => {
        const optionInputs = item.querySelectorAll('.form-check-input');

        optionInputs.forEach((input) => {
            input.addEventListener('click', () => {
                const name = input.name
                const value = input.value
                const index = requireds.findIndex((e) => e.name == name)

                // Verificação se já existe o item no array
                if (index !== -1) {
                    requireds[index].value = value
                } else {
                    requireds.push({ name: name, value: value })
                }

                if (requireds.length == 6 && input.name != 'qtdTreino') {
                    $('input[type=radio]').change(function () {
                        $('.carousel').carousel('next'); // Avança para o próximo slide
                    });

                    if (requireds.length > 6) {
                        // console.log('wee')
                    }
                }
            });
        });
    });

    days.addEventListener('change', function () {
        var D = parseInt(days.value)
        if (D <= 0) {
            // Erro de dia
        }
        else {
            const index = requireds.findIndex((e) => e.name == 'Days')
            console.log(requireds)
            if (index == -1) {
                var newData = { name: 'Days', value: days.value }
                requireds.push(newData)
            }
            else {
                requireds[index].value = days.value
            }


        }
    })

    hours.addEventListener('change', function () {
        var H = parseInt(hours.value)
        var M = parseInt(min.value)

        min.classList.remove('selecte-err')
        hours.classList.remove('selecte-err')

        const index = requireds.findIndex((e) => e.name == 'hours')
        const indexMin = requireds.findIndex((e) => e.name == 'min')

        // Verificação se já existe o item no array
        if (index !== -1) {
            requireds[index].value = hours.value
            if (indexMin !== -1) {
                requireds[indexMin].value = min.value
            }
        } else {
            requireds.push({ name: 'Hours', value: hours.value })
        }

        //Da um filter no array em busca dos minutos
        var find = requireds.filter(e => e.min != 'Min.')
        // Se não tiver minutos no arrai nao cria os exercicios
        if (find.length >= 9) {
            verificationRequireds()
        }

    })

    min.addEventListener('change', function () {
        var M = parseInt(min.value)
        var H = parseInt(hours.value)
        const index2 = requireds.findIndex((e) => e.min == min.value)

        if (M <= 39 && H <= 0) {
            //Lógica do erro
            min.classList.add('selecte-err')
            hours.classList.add('selecte-err')
            timeErr.classList.remove('d-none')
            if (index2 !== -1) {
                requireds[index2].value = min.value
            } else {
                requireds.push({ name: 'Min', value: min.value })
            }
        }
        else {
            timeErr.classList.add('d-none')
            // Verifica se já existe, se tiver att se nao adiciona
            if (index2 !== -1) {
                requireds[index2].value = min.value
            } else {
                requireds.push({ name: 'min', value: min.value })
            }

            //Da um filter no array em busca das horas
            var find = requireds.filter(e => e.hours != 'horas')
            // Se não tiver horas no arrai nao cria os exercicios
            if (find.length >= 9) {
                verificationRequireds()
            }
        }
    })

    function verificationRequireds() {
        var superband = requireds.filter(e => e.name == 'Superband')[0].value
        var paralelas = requireds.filter(e => e.name == 'Paralelas')[0].value
        var barraFixa = requireds.filter(e => e.name == 'Barra Fixa')[0].value
        var argolas = requireds.filter(e => e.name == 'Argolas')[0].value
        var trx = requireds.filter(e => e.name == 'Trx')[0].value
        var rodinha = requireds.filter(e => e.name == 'Rodinha Abdominal')[0].value
        var days = parseInt(requireds.filter(e => e.name == 'Days')[0].value)
        var horas = requireds.filter(e => e.name == 'Hours')[0]
        var min = requireds.filter(e => e.name == 'Min')[0]

        // Add os sem filtros
        var aux = exercises.filter(e => e.required == "")
        aux.forEach(e => {
            newExercises.push(e)
        })


        if (superband == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Superband');
                } else {
                    return e.required == 'Superband';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }
        if (paralelas == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Paralelas');
                } else {
                    return e.required == 'Paralelas';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }
        if (barraFixa == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Barra Fixa');
                } else {
                    return e.required == 'Barra Fixa';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }
        if (argolas == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Argolas');
                } else {
                    return e.required == 'Argolas';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }
        if (trx == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Trx');
                } else {
                    return e.required == 'Trx';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }
        if (rodinha == 'true') {
            var aux = exercises.filter(e => {
                if (Array.isArray(e.required)) {
                    return e.required.includes('Rodinha Abdominal ');
                } else {
                    return e.required == 'Rodinha Abdominal';
                }
            });
            aux.forEach(e => {
                newExercises.push(e)
            });
        }

        // Verifica se tem o minimo 
        if (paralelas == 'false' && barraFixa == 'false' && argolas == 'false' && trx == 'false') {
            const quiz = document.getElementById('quiz')
            quiz.classList.add('d-none')

            const divErr = document.getElementById('msgErr')
            divErr.classList.remove('d-none')
        }
        else {

            // Primeiro Exercicio
            paralelas == 'true' ?
                newExercisesBase.push(exercises.filter(e => e.name == 'Dips na paralela')[0]) :
                newExercisesBase.push(newExercises.filter(e => e.nivel == 2 && e.type == 'Vertical' && e.category == 'Push')[0])

            // Segundo Exercicio
            newExercisesBase.push(newExercises.filter(e => e.name == 'Flexão Padrão')[0])

            // Terceiro Exercicio
            barraFixa == 'true' ?
                newExercisesBase.push(exercises.filter(e => e.name == 'Pull Ups')[0]) :
                newExercisesBase.push(newExercises.filter(e => e.nivel == 3 && e.type == 'Vertical' && e.category == 'Pull')[0])

            // Quarto Exercicio
            newExercisesBase.push(exercises.filter(e => e.name == 'Rows/Barra Australiana')[0])

            // Quinto Exercicio
            newExercisesBase.push(exercises.filter(e => e.name == 'Full Squat (descer tudo)')[0])

            // Sexto Exercicio
            newExercisesBase.push(exercises.filter(e => e.name == 'Hip Thruster')[0])

            // Setimo Exercicio
            paralelas == 'true' ?
                newExercisesBase.push(exercises.filter(e => e.name == 'Tuck L-sit')[0]) :
                newExercisesBase.push(newExercises.filter(e => e.nivel == 2 && e.type == 'Abdômen' && e.category == 'Core')[0])

            // Oitavo Exercicio
            newExercisesBase.push(exercises.filter(e => e.name == '60s de Prancha Abdominal')[0])

            creatExercisesBase()
        }
    }

    async function saveRequireds(bool) {
        await apiPost('saveDU', requireds)
        bool ? window.location.href = '/bodybuilding' : window.location.href = '/hybrid'

    }

    // Desativa a rotação automática do carrossel
    quizCarousel.setAttribute('data-bs-interval', 'false');

    async function enviarTreino2() {
        if (treino.length == newExercisesBase.length) {
            //Enviando o valor de Paired Sets
            const pairedSets = document.getElementById('pairedSetsValue').checked
            var stre = ""
            pairedSets ? stre = "true" : stre = "false"
            const newAtt = { name: "Paired Sets", value: stre }
            treino.push(newAtt)

            // let res = requireds.filter(e => e.name == 'days')[0]
            // let days = parseInt(res.value)
            // let newData = { name: 'days', value: days }
            treino.push(requireds)

            loading(true)
            try {
                const response = await fetch('/sendTraining', {
                    method: 'POST',
                    body: JSON.stringify(treino),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                if (response.redirected) {
                    window.location.replace(response.url);
                } else {
                    //loadExer(false)
                }
            } catch (error) {
                console.error('Erro na requisição:', error);
                // Esconde a animação de carregamento
                loadExer(false)
            }
        } else {
            addColorError()
        }


    }
</script>

{% endblock %}